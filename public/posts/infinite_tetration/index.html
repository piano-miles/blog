<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><title>Efficiently Computing Infinite Tetration &#183; Waugh Blog - Miles Waugh</title>
<meta name=title content="Efficiently Computing Infinite Tetration &#183; Waugh Blog - Miles Waugh"><script type=text/javascript src=/js/appearance.min.74ad8406faea02f3e186ba5126249aaeed9073629e04b05037b903396b188724.js integrity="sha256-dK2EBvrqAvPhhrpRJiSaru2Qc2KeBLBQN7kDOWsYhyQ="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.c12168fe89e3d591584966ab97550a5461292b063a6bbab1e73f36fd0f4d82a9.css integrity="sha256-wSFo/onj1ZFYSWarl1UKVGEpKwY6a7qx5z82/Q9Ngqk="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.657cb571a9dba2d256ea32b6b642035475ce1495cb1cb41f9d4551719724aade.js integrity="sha256-ZXy1canbotJW6jK2tkIDVHXOFJXLHLQfnUVRcZckqt4=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      
        I analyze the infinite tetration (or &ldquo;power tower&rdquo;) and derive efficient methods for computing it.
      
    "><link rel=canonical href=https://blog.mileswaugh.com/posts/infinite_tetration/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://blog.mileswaugh.com/posts/infinite_tetration/"><meta property="og:site_name" content="Waugh Blog - Miles Waugh"><meta property="og:title" content="Efficiently Computing Infinite Tetration"><meta property="og:description" content="I analyze the infinite tetration (or “power tower”) and derive efficient methods for computing it."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-28T18:00:00-08:00"><meta property="article:modified_time" content="2025-03-28T18:00:00-08:00"><meta property="article:tag" content="Math"><meta property="article:tag" content="Numerical Analysis"><meta property="article:tag" content="Long"><meta name=twitter:card content="summary"><meta name=twitter:title content="Efficiently Computing Infinite Tetration"><meta name=twitter:description content="I analyze the infinite tetration (or “power tower”) and derive efficient methods for computing it."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Efficiently Computing Infinite Tetration","headline":"Efficiently Computing Infinite Tetration","abstract":"I analyze the infinite tetration (or \u0026ldquo;power tower\u0026rdquo;) and derive efficient methods for computing it.","inLanguage":"en","url":"https:\/\/blog.mileswaugh.com\/posts\/infinite_tetration\/","author":{"@type":"Person","name":"Miles Waugh"},"copyrightYear":"2025","dateCreated":"2025-03-28T18:00:00-08:00","datePublished":"2025-03-28T18:00:00-08:00","dateModified":"2025-03-28T18:00:00-08:00","keywords":["math","numerical analysis","long"],"mainEntityOfPage":"true","wordCount":"5111"}</script><meta name=author content="Miles Waugh"><link href="https://github.com/piano-miles?tab=repositories" rel=me><link href=https://piano-miles.github.io/home/ rel=me><link href=https://www.linkedin.com/in/miles-waugh/ rel=me><link href=https://www.youtube.com/@mileswaugh rel=me><link type=text/css rel=stylesheet href=/lib/katex/katex.min.af6f85907cdfd6ed3e4906d93a8233d91c5638859f744cd1b98c9b1a3ccaab5f231bdcda49f132f6cdfe8cca86ff33ed468affab8a9a502610a664a34f0f0cfa.css integrity="sha512-r2+FkHzf1u0+SQbZOoIz2RxWOIWfdEzRuYybGjzKq18jG9zaSfEy9s3+jMqG/zPtRor/q4qaUCYQpmSjTw8M+g=="><script defer src=/lib/katex/katex.min.20da6cf7343619410c0900fbc626506c65159ea9f312f9729d5cba7aa713707378f9a4222e8f7fb9a42a7240e9749f199b7334401b3e3e4b60e29cf490492552.js integrity="sha512-INps9zQ2GUEMCQD7xiZQbGUVnqnzEvlynVy6eqcTcHN4+aQiLo9/uaQqckDpdJ8Zm3M0QBs+Pktg4pz0kEklUg=="></script><script defer src=/lib/katex/auto-render.min.6095714e3aadb63b14ddc4af69346ab12974c1b460654345f8d1860a0b68fcc51b22f68b757433193090bb80afc8965b65cb607e5541d0f5f0f4b2e64d69b9ff.js integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" onload=renderMathInElement(document.body)></script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 print:hidden sm:py-10 dark:text-neutral"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Waugh Blog - Miles Waugh</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><button id=search-button-1 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=https://github.com/piano-miles title target=_blank><span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/posts/ title=Posts><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Posts</span></a></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Efficiently Computing Infinite Tetration</h1><div class="mb-12 mt-8 text-base text-neutral-500 print:hidden dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2025-03-28 18:00:00 -0800 -0800">28 March 2025</time><span class="px-2 text-primary-500">&#183;</span><span>5111 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">24 mins</span></div><div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/tags/math/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Math</a>
<a href=/tags/numerical-analysis/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Numerical Analysis</a>
<a href=/tags/long/ class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Long</a></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 print:hidden lg:sticky lg:top-10"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#the-naïve-approach>The Naïve Approach</a></li><li><a href=#structure-analysis>Structure Analysis</a><ul><li><a href=#fixed-point-iteration>Fixed-Point Iteration</a></li><li><a href=#plotting-behavior>Plotting Behavior</a></li><li><a href=#deriving-key-points>Deriving Key Points</a></li></ul></li><li><a href=#solving-with-lambert-w>Solving with Lambert W</a></li><li><a href=#the-newton-raphson-method>The Newton-Raphson Method</a><ul><li><a href=#results>Results</a></li></ul></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><p>In this blog post, I derive an efficient method to stably compute the infinite tetration (or &ldquo;power tower&rdquo;). &ldquo;Tetration&rdquo; simply means repeated exponentiation, so &ldquo;infinite tetration&rdquo; simply means exponentiation an infinite number of times. The infinite tetration of \(x\), which I will call \(y\), is defined as:
$$y=x^{x^{x^{.^{.^{.}}}}}$$
The first method I derive turns the problem into an integral which can be solved numerically. The second method that I derive, and the main focus of this blog post, is an iterative method that achieves stable quadratic convergence for all valid \(x\). &ldquo;Iterative&rdquo; simply means that the method constructs successively more accurate approximations until the approximation error is within a desired tolerance of the true solution. In this post, I also discuss the structure of the infinite tetration, and I derive when it converges or &ldquo;oscillates&rdquo; (more on that later).</p><hr><h2 id=the-naïve-approach class="relative group">The Naïve Approach <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-na%c3%afve-approach aria-label=Anchor>#</a></span></h2><p>The most straightforward way to compute the infinite power tower \(y\) of an input \(x\) is to repeatedly raise \(x\) to the power of more \(x\)&rsquo;s. The idea is that the <em>infinite</em> power tower, which we can not compute (it requires an infinite number of operations), is sufficiently similar to a <em>very large</em> power tower, which we can compute. As we will discover later, however, there are certain inputs where this approach is problematic. It is important to note that repeated exponentiation is <em>right-associative</em>, not <em>left-associative</em>. That means \(a^{b^{c}}=a^{\left(b^{c}\right)}\neq\left(a^{b}\right)^{c}\). Mathematically, the Naïve approach is then:</p><p>$$y_0 = x$$
$$y_1 = x^x = x^{y_0}$$
$$y_2 = x^{x^{x}} = x^{y_1}$$
$$\vdots$$
$$y_n = x^{y_{n-1}}$$</p><p>In the limit as we raise \(x\) to the power of itself more times, it converges on the solution \(y\) if one exists. However, this approach converges quite slowly for many values of \(x\). Furthermore, for small \(x\), the sequence oscillates indefinitely, and the values between which it oscillates converge.</p><p>To see how inefficient this is for some inputs, look at this example of convergence of 0.4 raised to the power of itself repeatedly:</p><table><thead><tr><th>n</th><th>\(y_n\)</th><th>Absolute error ( \(\left | y_n-y_{\infty}\right | \) )</th></tr></thead><tbody><tr><td>0</td><td>0.40000000000</td><td>0.18504317197</td></tr><tr><td>1</td><td>0.69314484316</td><td>0.10810167118</td></tr><tr><td>2</td><td>0.52987073647</td><td>0.05517243550</td></tr><tr><td>3</td><td>0.61537979747</td><td>0.03033662550</td></tr><tr><td>4</td><td>0.56900457469</td><td>0.01603859728</td></tr><tr><td>5</td><td>0.59370446436</td><td>0.00866129238</td></tr><tr><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td></tr><tr><td>35</td><td>0.58504317204</td><td>0.00000000007</td></tr><tr><td>36</td><td>0.58504317194</td><td>0.00000000003</td></tr><tr><td>37</td><td>0.58504317199</td><td>0.00000000002</td></tr><tr><td>38</td><td>0.58504317196</td><td>0.00000000001</td></tr><tr><td>39</td><td>0.58504317198</td><td>0.00000000001</td></tr></tbody></table><p>Here is an example of &ldquo;oscillatory&rdquo; behavior with 0.02 raised to the power of itself repeatedly:</p><table><thead><tr><th>n</th><th>\(y_n\)</th></tr></thead><tbody><tr><td>0</td><td>0.0200000000</td></tr><tr><td>1</td><td>0.9247420362</td></tr><tr><td>2</td><td>0.0268467067</td></tr><tr><td>3</td><td>0.9003020739</td></tr><tr><td>&mldr;</td><td>&mldr;</td></tr><tr><td>26</td><td>0.0314614034</td></tr><tr><td>27</td><td>0.8841949279</td></tr><tr><td>28</td><td>0.0314614938</td></tr><tr><td>29</td><td>0.8841946152</td></tr><tr><td>30</td><td>0.0314615323</td></tr></tbody></table><p>As we approach an infinite number of iterations, the sequence tends toward bouncing between two values. Of course, you might imagine that large numbers raised to the power of themselves will keep getting larger forever. Here is an example of 1.5 raised to itself repeatedly, where the infinite tetration spirals to infinity:</p><table><thead><tr><th>n</th><th>\(y_n\)</th></tr></thead><tbody><tr><td>1</td><td>1.500000000</td></tr><tr><td>2</td><td>1.837117307</td></tr><tr><td>3</td><td>2.106203352</td></tr><tr><td>&mldr;</td><td>&mldr;</td></tr><tr><td>9</td><td>4.382546732</td></tr><tr><td>10</td><td>5.911914873</td></tr><tr><td>11</td><td>10.99098293</td></tr><tr><td>12</td><td>86.18189174</td></tr><tr><td>13</td><td>1,499,263,005,586,587</td></tr><tr><td>14</td><td>5.400339825 × 10^264,007,110,309,345</td></tr></tbody></table><p>By the 14th iteration, it is quite evident that the sequence tends to infinity.</p><p>I&rsquo;ve plotted the true infinite tetration curve below, in green, alongside the naïve approach for computing it, in red:</p><p><figure><img src=./media/gif/naive_1.gif alt="Animation of the naïve approach of computing the infinite tetration." class="mx-auto my-0 rounded-md"></figure></p><p>Notice how, for small values below a threshold between 0 and 0.2, the numbers oscillate between two values in the limit as the number of iterations approaches infinity. These two values are denoted by the dashed green line. In this region, the infinite tetration is technically not defined, because it does not converge to a single value. Above that &ldquo;branching point,&rdquo; until a point a bit greater than 1.4, the infinite tetration does converge to a single value. These are denoted by the solid green line. Finally, above some point between 1.4 and 1.5, the infinite tetration diverges toward infinity.</p><p>Given these observations, I would like to answer the following questions:</p><ul><li>When does the infinite tetration converge? When does it oscillate indefinitely? When does it blow up to infinity? Can we rigorously derive exactly where these transitions occur?</li><li>Can we find a &ldquo;better&rdquo; way to compute the result of the infinite tetration (either what value the sequence converges to, or between what values it oscillates between)?</li></ul><p>Moving forward in this blog post, I will neglect the infinite tetration of negative numbers. This is because, inevitably, you will encounter complex numbers; I wish to remain within the reals this time. The only exception to this is the infinite tetration of -1, which is -1. And that&rsquo;s rather boring.</p><p>In the next section, <strong>Structure Analysis</strong>, I will address the first bullet point. In the following two sections, I will address the second bullet point.</p><hr><h2 id=structure-analysis class="relative group">Structure Analysis <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#structure-analysis aria-label=Anchor>#</a></span></h2><h3 id=fixed-point-iteration class="relative group">Fixed-Point Iteration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#fixed-point-iteration aria-label=Anchor>#</a></span></h3><p>Recall the naïve approach:</p><p>$$y_n = x^{y_{n-1}}$$</p><p>We say that the sequence &ldquo;converges&rdquo; if the <a href=https://en.wikipedia.org/wiki/Limit_%28mathematics%29 target=_blank rel=noreferrer>limit</a> \(y_{\infty}=\lim_{n\to\infty}y_n\) exists. If the sequence does indeed converge, then the solution we seek, \(y_{\infty}\), is unchanged when \(x\) is raised to its power (in both cases, \(x\) is raised to itself an infinite number of times):</p><p>$$y_{\infty}=x^{y_{\infty}}$$</p><p>Alternatively, we can think of the naïve approach as creating a variable \(z\) which is initialized to \(x\), and is updated by applying the function:</p><p>$$z\to f\left(z\right)$$</p><p>Where \(f\left(z\right)=x^z\). If we repeatedly apply this, then we hope that \(z\) will approach \(y_\infty\) if \(y_{\infty}\) does exist. Our problem, then, is to find a &ldquo;fixed point&rdquo; of \(f\): that is, a value \(z\) such that \(f\left(z\right)=z\). This is called a fixed point because the value of \(z\) remains fixed under application of the function \(f\). Repeatedly passing the variable through the function and setting the variable to the resulting value is called a fixed-point iteration. Often, we can find fixed points of a function by simply repeatedly applying the fixed-point iteration. The variable will keep changing until it reaches the fixed point, after which it will remain at the fixed point.</p><p>For instance, take the function \(f\left(z\right)=\sin\left(z\right)+z\). It is not difficult to realize that this function has an infinite number of fixed points at \(z=n\pi\) for all \(n\in\mathbb{Z}\). At these points, \(\sin\left(z\right)\) is 0, so the function simply returns \(z\). If we approximate the fixed point as \(3\), we can write some simple Python code and watch as the fixed-point iteration converges quickly on \(\pi\):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z_0: </span><span class=si>{</span><span class=n>z</span><span class=si>:</span><span class=s2>.11f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>+=</span> <span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z_</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>z</span><span class=si>:</span><span class=s2>.11f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;π:   </span><span class=si>{</span><span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=si>:</span><span class=s2>.11f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>Which gives the following output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>z_0: 3.00000000000
</span></span><span class=line><span class=cl>z_1: 3.14112000806
</span></span><span class=line><span class=cl>z_2: 3.14159265357
</span></span><span class=line><span class=cl>z_3: 3.14159265359
</span></span><span class=line><span class=cl>z_4: 3.14159265359
</span></span><span class=line><span class=cl>π:   3.14159265359
</span></span></code></pre></div><p>In fact, this method converges with cubic convergence! I will not explain why in detail as it is out of the scope of this post, but the reason ends up being because \(0=f&rsquo;\left(\pi\right)=f&rsquo;&rsquo;\left(\pi\right)\ne f^{\left(3\right)}\left(\pi\right)=1\). This method for computing pi is generally not very useful in practice, however, because the computer has to compute a Taylor series for the sine function, which involves a lot of floating-point operations per function call. We may as well just compute \(\pi=4\arctan\left(1\right)\) if we&rsquo;re using trig functions at all, which is just a single function call.</p><p>Hopefully I&rsquo;ve convinced you that fixed-point iteration can be very useful at times. However, we have no reason to believe that fixed-point iteration will always lead us to the fixed point of the function. Consider the function \(f\left(z\right)=z^2-2\) as an example. The fixed point \(p\) of the function \(f\) is easy to solve for:</p><p>$$p=p^2-2$$
$$p^{2}-p-2=0$$
$$\left(p-2\right)\left(p+1\right)=0$$
$$p=2,-1$$</p><p>Let&rsquo;s say we estimate \(p\) to be about \(z_0=1.5\). It&rsquo;s between the two fixed points, so surely it will converge on one. Right? We can write some simple Python code to perform the fixed-point iteration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=mf>1.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>15</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>z</span> <span class=o>*</span> <span class=n>z</span> <span class=o>-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>z</span><span class=si>:</span><span class=s2>+0.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>This yields the following output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gi>+0.250
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-1.938
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+1.754
</span></span></span><span class=line><span class=cl><span class=gi>+1.076
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-0.842
</span></span></span><span class=line><span class=cl><span class=gd>-1.291
</span></span></span><span class=line><span class=cl><span class=gd>-0.332
</span></span></span><span class=line><span class=cl><span class=gd>-1.889
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+1.570
</span></span></span><span class=line><span class=cl><span class=gi>+0.465
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-1.783
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+1.181
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-0.606
</span></span></span><span class=line><span class=cl><span class=gd>-1.633
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+0.668
</span></span></span></code></pre></div><p>It went all over the place! Using the fixed point iteration did not converge to any fixed points of the function. Maybe it would help if we provided an initial estimate that was very close to the value. Let us now begin with an initial guess very close to 2:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=mf>1.99</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>15</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=n>z</span> <span class=o>*</span> <span class=n>z</span> <span class=o>-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>z</span><span class=si>:</span><span class=s2>+0.3f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>But this does not converge to 2 either:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gi>+1.960
</span></span></span><span class=line><span class=cl><span class=gi>+1.842
</span></span></span><span class=line><span class=cl><span class=gi>+1.393
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-0.060
</span></span></span><span class=line><span class=cl><span class=gd>-1.996
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+1.986
</span></span></span><span class=line><span class=cl><span class=gi>+1.943
</span></span></span><span class=line><span class=cl><span class=gi>+1.776
</span></span></span><span class=line><span class=cl><span class=gi>+1.154
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-0.669
</span></span></span><span class=line><span class=cl><span class=gd>-1.553
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+0.411
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-1.831
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+1.353
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gd>-0.170
</span></span></span></code></pre></div><p>In fact, unless your initial estimate is exactly the fixed point, the fixed-point iteration will never converge on either of the fixed points! From this, it follows that we may want to distinguish between two types of fixed points: the type that we will converge on via the fixed-point iteration, and the type that we will never converge on.</p><hr><p>It is finally time to characterize fixed points. If a fixed point has a <a href=https://en.wikipedia.org/wiki/Neighbourhood_%28mathematics%29 target=_blank rel=noreferrer>neighborhood</a> of points around it that converge on it, we call that fixed-point <strong>attracting</strong>. The largest such neighborhood of that point is called the <strong>basin of attraction</strong>. You might guess that the fixed point 2 in the second example is not attracting, whereas the fixed point \(\pi\) from the first example is attracting.</p><p>Similarly, there is a notion of <em>repelling</em> fixed points, such as the fixed points in the second example. Even if your guess is very close to 2, the iteration will repel the guess away from 2. Finally, there is a notion of a <em>periodic</em> point, which is some value that the system will periodically return to. The points that the repeated tetration oscillates between in the limit as the iteration count approaches infinity are examples of periodic points. In this post, we will primarily be concerned with whether a fixed point is attracting or not, since that determines convergence. We will also be interested in finding an attracting fixed point&rsquo;s basin of convergence, because that is a region within which an initial guess is theoretically guaranteed to converge.</p><p>This begs the question: is there a way to definitively <em>prove</em> whether a fixed point is attracting? Furthermore, can we determine its basin of attraction? This is exactly what the <strong>Banach fixed-point theorem</strong> allows us to do, provided that the fixed-point iteration \(f\) is continuous. While not strictly necessary, it also helps mathematically if the fixed-point iteration is differentiable. You&rsquo;ll see why in a moment.</p><p>I will briefly note, however, that the theorem also allows us to prove whether a fixed point exists in a region of the function&rsquo;s domain. This can be useful, for instance, if we can&rsquo;t solve for the fixed points of a function. I will skip this part of the theorem entirely as it is not relevant to this blog post, but I may revisit it in a future post.</p><p>Generally, the function \(f\) is defined on a &ldquo;metric space&rdquo; \(\left(X,d\right)\). You can think of this as a set of points \(X\) equipped with the additional structure of a &ldquo;distance,&rdquo; \(d\), defined between points. \(d\) itself is a function that takes in two points from our space and outputs a nonnegative number, called the &ldquo;distance&rdquo; between the points. This distance function can be anything as long as it satisfies four simple axioms. I will briefly state them here in plain English, but they are not relevant to this post:</p><ol><li>The distance from a point to itself is zero.</li><li>The distance between two different points is positive.</li><li>The distance from x to y is the distance from y to x.</li><li>The distance between x and z can never be greater than the sum of distances between x and y and between y and z.</li></ol><p>The fixed-point iteration \(f\) must necessarily map \(f: X\to X\) (it maps from a space onto the same space). This requirement should make intuitive sense: for a fixed point to be a fixed point, the function should not affect it. The fixed point \(p\) satisfies \(f(p)=p\), so \(f(p)\) and \(p\) are both in \(X\).</p><p>What the Banach fixed-point theorem states is that a fixed point \(p\) of \(f\) will be attracting if \(f\) is a <strong>contraction mapping</strong> in some neighborhood around \(p\). Then, the largest such neighborhood is the basin of attraction. We say that \(f\) is a contraction mapping if there exists a constant \(0\leq k&lt;1\) such that for all \(x,y\in X\), the following inequality holds:</p><p>$$d\left(f(x),f(y)\right)\leq k\cdot d(x,y)$$</p><p>Intuitively, we choose two points in the space and apply the function to both. If the distances between the points contract under the fixed-point iteration for all pairs of points that we choose, then the function is a contraction mapping. It should make sense why this theorem is true: if the function application does not contract points into the fixed point, then points will never converge to the fixed point. But if the function application does contract points into the fixed point, then points will converge to the fixed point. I leave the proof of the theorem as an exercise to the reader, as it is a relatively straightforward proof.</p><p>In our case, because \(f\) is a map \(f:\mathbb{R}\to\mathbb{R}\), we can use the Euclidean distance as our metric:</p><p>$$d(x,y)=\left|x-y\right|$$</p><p>The Banach fixed-point theorem states that our fixed-point iteration will be contractive over some domain \(X\subseteq\mathbb{R}\) if there exists a constant \(0\leq k&lt;1\) such that, for all \(x,y\in X\), the following inequality holds:</p><p>$$\left|f(x)-f(y)\right|\leq k\cdot\left|x-y\right|$$</p><p>Using the mean value theorem, we can rewrite this inequality as:</p><p>$$\left|f&rsquo;(z)\right|\leq k$$</p><p>Where \(z\) is some point between \(x\) and \(y\). This is a much more convenient form of the inequality to check. You can intuitively think of this as checking that the condition described is satisfied for the subset of all pairs of points that are infinitesimally close. If you wish to check the distance between two points that are a finite distance apart, then you must sum the distances between all the infinitesimally close points that lie between the two points. If all of the infinitesimal distances contract, then the finite distance which is their sum will also contract. If we can find a constant \(0\leq k&lt;1\) such that the derivative of the fixed-point iteration is less than \(k\) for all points in a neighborhood of a fixed point, then we can conclude that the fixed-point attracting.</p><p>With my example of \(f(z)=z^2-2\), the fixed point 2 is not attracting because, where \(f&rsquo;(z)=2z\):</p><p>$$\left|f&rsquo;(2)\right| = 4 > 1 > k$$</p><p>The derivative is only less than 1 when \(z\in(-\frac{1}{2},\frac{1}{2})\), which does not contain any fixed points of the function. Therefore, all fixed points of the function are not attracting, and the fixed-point iteration will not work.</p><p>This theorem will serve us well soon enough, since we observed that the infinite tetration can be represented as a fixed point of a function.</p><hr><h3 id=plotting-behavior class="relative group">Plotting Behavior <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#plotting-behavior aria-label=Anchor>#</a></span></h3><p>Back to the infinite tetration: let&rsquo;s make some plots. The first step is to express the infinite tetration \(y\) of \(x\) recursively as:</p><p>$$x^y=y$$</p><p>If we plot this equation, we get the following red curve. Ignore the green curve for now (we&rsquo;ll talk about it shortly):</p><p><figure><img src=./media/svg/branches.svg alt="Graph of x^y=y" class="mx-auto my-0 rounded-md"></figure></p><p>Interestingly, if we instead graph the application of two iterations:</p><p>$$x^{x^y}=y$$</p><p>Then we get the same curve, but with an additional two green <a href=https://mathworld.wolfram.com/Branch.html target=_blank rel=noreferrer>branches</a> when x is small, colored above as the green curve. These two green branches correspond to the values which the naïve sequence oscillates between in the limit as the number of iterations approaches infinity. When \(x\) is larger than where the green curve exists, the sequence will converge on the red curve. Finally, to the right of the point where the red curve bends backward (to the left, where there now appear to be multiple values for the tetration for a single input), which is also the upper bound on the domain of the curve, all values will diverge to infinity.</p><p>Why do the branches only appear with the more complicated expression? If you compute the iteration only once, then in the oscillatory region, the value will flip to the other value between which the sequence is oscillating. But if you apply the iteration twice, then the value will flip twice, back to its original value. The first graph plots what is invariant under a single iteration, while the second graph plots what is invariant under two iterations.</p><hr><h3 id=deriving-key-points class="relative group">Deriving Key Points <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#deriving-key-points aria-label=Anchor>#</a></span></h3><p>Let&rsquo;s establish some important points on the curve. The trivial cases are when \(x=0\) and \(x=1\). When \(x=0\), the infinite tetration oscillates between 0 and 1. This is because anything raised to the power of 0 is 1, and anything raised to the power of 1 is unaffected. So \(0^0=1\), \(0^{0^0}=0^{1}=0\), and the cycle repeats. Raising 1 to the power of itself is just 1, so the infinite tetration of 1 is 1.</p><p>Let&rsquo;s find out where the curve goes from converging to diverging. The curve is vertical when \(\frac{dx}{dy}=0\). We can solve for \(x\):
$$x^y=y\implies x = \sqrt[y]{y}$$
And differentiate:
$$\frac{dx}{dy}=-y^{\frac{1}{y}-2}(\ln(y)-1)=0$$
Which is true when \(y^{\frac{1}{y}-2}=0\) and when \(\ln(y)=1\). Thus, the curve is vertical when \(y=0\) and when \(y=e\). That means the curve is vertical when \(x=0\) and \(x=\sqrt[e]{e}\). This tells us when the infinite tetration will diverge to infinity: whenever we are infinitely tetrating a number greater than \(\sqrt[e]{e}\). The largest value that can be infinitely-tetrated is \(\sqrt[e]{e}\), converging to the largest infinitely-tetrated value, \(e\).</p><p>To find when the curve transitions from oscillating to converging to a single value, we can use the Banach fixed-point theorem. The derivative of the fixed-point iteration \(f\left(y\right)=x^{y}\) is:
$$f&rsquo;\left(y\right)=\frac{d}{dy}\left[x^{y}\right]=x^{y}\ln\left(x\right)$$
Because the basin of attraction is where the magnitude of the derivative is less than 1, the boundary of the basin is when the derivative is exactly 1 or -1. If we consider \(0 &lt; x &lt; 1\), then \(\ln(x)\) is strictly negative and \(x^y\) is strictly positive, meaning g&rsquo;(y) is strictly negative. That means we can simply check when \(g&rsquo;(y) = -1\). Thus, we are interested in the values of \(x\) such that:
$$x^{y}\ln\left(x\right)=-1\implies y=\frac{\ln\left(-\frac{1}{\ln\left(x\right)}\right)}{\ln\left(x\right)}$$
We also know, additionally, that \(x^{y}=y\), so:
$$x^{\frac{\ln\left(-\frac{1}{\ln\left(x\right)}\right)}{\ln\left(x\right)}}=\frac{\ln\left(-\frac{1}{\ln\left(x\right)}\right)}{\ln\left(x\right)}$$
$$\implies-\frac{1}{\ln(x)}=\frac{\ln\left(-\frac{1}{\ln(x)}\right)}{\ln(x)}$$
$$\implies \frac{\ln\left(-\frac{1}{\ln(x)}\right)+1}{\ln(x)}=0$$
$$\implies x=e^{-e}$$
And
$$y=\frac{\ln\left(-\frac{1}{\ln\left(e^{-e}\right)}\right)}{\ln\left(e^{-e}\right)}=\frac{1}{e}$$</p><p>Indeed, the curve is undefined on \(\left(-\infty,0\right)\), oscillates on \(\left[0,e^{-e}\right)\), converges on \(\left[e^{-e},\sqrt[e]{e}\right]\), and diverges on \(\left(\sqrt[e]{e},\infty\right)\).</p><p>What we would like to do is formulate a method that efficiently converges to all branches in order to determine what the infinite tetration converges to, what it tends toward, or what it oscillates between.</p><p>From hereon, take note: I will often consider the curve \(x^{x^y}=y\), as opposed to \(x^y=y\), as it has the more &ldquo;complete&rdquo; structure.</p><hr><h2 id=solving-with-lambert-w class="relative group">Solving with Lambert W <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#solving-with-lambert-w aria-label=Anchor>#</a></span></h2><p>Our first step should be to attempt to solve for the infinite tetration, \( y \), directly. However, in order to solve for \(y\) exactly, we require the <strong>Lambert W function</strong> \(W(z)\), which can not be expressed using only elementary functions. The Lambert W function is the function that satisfies:</p><p>$$W(z) e^{W(z)} = z$$</p><p>You can get this result by rearranging \(y=x^y\) into</p><p>$$\ln\left(\frac{1}{y}\right)e^{\ln\left(\frac{1}{y}\right)}=-\ln\left(x\right)$$</p><p>And, by the definition of the Lambert W function:</p><p>$$W\left(-\ln\left(x\right)\right)e^{W\left(-\ln\left(x\right)\right)}=-\ln\left(x\right)\implies W\left(-\ln\left(x\right)\right)=\ln\left(\frac{1}{y}\right)$$</p><p>From here, we easily obtain the solution in terms of the Lambert W function:</p><p>$$y=-\frac{W\left(-\ln\left(x\right)\right)}{\ln\left(x\right)}$$</p><p>Because we are left with the Lambert W function, which is irreducible, this motivates a numerical approach. The presence of that function demonstrates that it is impossible to exactly represent a formula in closed form. If our problem could be solved exactly using a finite number of elementary operations and functions, then so would the Lambert W function, which we know is not the case.</p><p>One potential technique to solve the problem may be to compute the Lambert W function. We can employ an integral to compute the Lambert W function that was derived by <a href=https://www.uwo.ca/apmaths/faculty/jeffrey/pdfs/BersteinPick.pdf target=_blank rel=noreferrer>Kalugin, Jeffrey, and Corless</a> in 2011, giving:</p><p>$$y=-\frac{1}{\ln\left(x\right)\pi}\int_{0}^{\pi}\ln\left(1-\frac{1}{t}\ln\left(x\right)\sin\left(t\right)e^{t\cot\left(t\right)}\right)dt$$</p><p>Note that this integral gives only the center branch present in \(y=x^y\). The integrand is reasonably well-behaved and looks like this:</p><p><figure><img src=./media/raster/W_integrand.jpg alt="Integrand of the Lambert W function integral derived in 2011" class="mx-auto my-0 rounded-md"></figure></p><p>At the corner where \(x=\sqrt[e]{e}\) and \(t=0\), the integrand diverges to \(-\infty\). You can check this by substituting in the value for \(x\) and taking \(t\to0^{+}\) in the limit to get:</p><p>$$\lim_{t\to0^{+}}\ln\left(1-\frac{1}{t}\sin(t)e^{t\cot(t)-1}\right)$$</p><p>We&rsquo;re interested in the limit of the t-dependent term:</p><p>$$\lim_{t\to0^{+}}\frac{1}{t}\sin(t)e^{t\cot(t)-1}$$</p><p>Notice that \(\sin\left(x\right)\), \(x\), and \(\cot\left(x\right)\) are all odd functions, so \({\sin\left(x\right)}/{x}\) and \(x\cot\left(x\right)\) are even, making the whole expression even. Thus, instead of only considering the right-hand limit, I will consider the limit from both sides (for simplicity, because the RH and LH limits equal each other).</p><p>Using L&rsquo;Hôpital&rsquo;s rule:</p><p>$$\lim_{t\to0}\frac{\sin(2t)-t}{\sin\left(t\right)}e^{t\cot(t)-1}$$
$$=\lim_{t\to0}\frac{\sin(2t)-t}{\sin\left(t\right)}\cdot\lim_{t\to0}e^{t\cot(t)-1}$$</p><p>Using L&rsquo;Hôpital&rsquo;s rule again, the left-hand limit becomes:</p><p>$$\lim_{t\to0}\left[4 \cos (t)-3 \sec (t)\right]=1$$</p><p>Using L&rsquo;Hôpital&rsquo;s rule again on \(t\cot(t)={t}/{\tan\left(t\right)}\), the right-hand limit becomes:</p><p>$$\lim_{t\to0}e^{\cos^{2}\left(t\right)-1}=1$$</p><p>If you differentiate the original term \(\frac{1}{t}\sin(t)e^{t\cot(t)-1}\) twice and again solve for the limit as \(t\to0\), you will obtain a value of -1. Because the term has even symmetry and negative curvature, the term must be approaching 1 from the negative end. Thus, the limit that we were originally interested in is:</p><p>$$\lim_{t\to1^{-}}\ln\left(1-t\right)=-\infty$$</p><p>This checks out because \(t\) is not defined above 1 on the reals (we can not approach from the positive side). This shows that the integrand goes to \(-\infty\) at this point, and special measures may be useful for taking this into account when numerically approximating the integral.</p><p>It turns out that a simple substitution works nicely to tame the singularity. If we define the integrand as a function \(I\):</p><p>$$y=-\frac{1}{\ln\left(x\right)\pi}\int_{0}^{\pi}I\left(x,t\right)dt,$$
$$I\left(x,t\right):=\ln\left(1-\frac{1}{t}\ln\left(x\right)\sin\left(t\right)e^{t\cot\left(t\right)}\right)$$</p><p>And make the substitution \(t=u^{2},\ dt=2u\ du\), then the integral becomes:</p><p>$$y=-\frac{1}{\ln\left(x\right)\pi}\int_{0}^{\sqrt{\pi}}2uI\left(x,u^{2}\right)du$$
$$=-\frac{2}{\pi\ln(x)}\int_{0}^{\sqrt{\pi}}t\ln\left(1-\frac{1}{t^{2}}\sin\left(t^{2}\right)e^{t^{2}\cot\left(t^{2}\right)}\ln(x)\right)dt$$</p><p>This integrand looks like this:</p><p><figure><img src=./media/raster/transformed_integral.jpg alt="Transformed integrand." class="mx-auto my-0 rounded-md"></figure></p><p>The level curves at fixed \(x\) are very nice. Note now, however, that this integrand very rapidly diverges to \(\infty\) as \(x\to0^{+}\). This is not obvious from the graph because this occurs for extremely small \(x\), but you can prove it easily; the integrand is of the form \(t\ln\left(1-f\left(t\right)\ln\left(x\right)\right)\), and \(\ln\left(x\right)\) approaches \(-\infty\) as \( x\to0^{+} \). Thus you would want to use this integrand only when \(x\) is close to \(\sqrt[e]{e}\), and the other integrand otherwise.</p><p>This completes the method of solving the problem using numerical integration. In the remainder of this blog post, I will use the Newton-Raphson method (which I have discussed briefly in the previous blog post) to solve the problem.</p><hr><h2 id=the-newton-raphson-method class="relative group">The Newton-Raphson Method <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-newton-raphson-method aria-label=Anchor>#</a></span></h2><p>The general strategy that I employ for solving the problem is turning it into a root-finding problem, which we can use the Newton-Raphson method to solve provided we have a decent enough initial approximation of the curve. I will use the simpler curve \( x^y=y \) for \(x\in\left(0,e^{-e}\right)\) due to its minimal computational complexity. I will use the more complicated curve \(x^{x^y}=y\) for \(x\in\left(e^{-e},\sqrt[e]{e}\right)\) due to its more complete structure.</p><p>We can rearrange the equations to create root-finding problems:</p><p>$$0=x^{y}-y=:g_{1}(y)$$
$$0=x^{y}\ln\left(x\right)-\ln\left(y\right)=g_{2}(y)$$</p><p>I obtained the second equation by first taking the natural log of both sides to collapse the exponents. What we&rsquo;ve constructed are functions \(g_{1,2}(y)\), provided some \(x\), which is 0 only when \(y\) is the infinite tetration of \(x\). For this problem, we can use the Newton-Raphson method, which I&rsquo;ve briefly discussed in a previous blog post. In essence, to find \(z\) such that \(g(z)=0\), we compute the fixed-point iteration \(z\to f(z)\) where</p><p>$$z\mapsto f_{1}\left(z\right)=z-\frac{g\left(z\right)}{g&rsquo;\left(z\right)}$$</p><p>And you can easily find the derivative with the quotient rule, which determines convergence via the Banach fixed-point theorem:</p><p>$$-1&lt;f&rsquo;\left(z\right)=\frac{g\left(z\right)g&rsquo;&rsquo;\left(z\right)}{g&rsquo;\left(z\right)^{2}}&lt;1$$</p><p>Using the functions which we wish to find the roots of, we can construct the Newton-Raphson iterations:</p><p>$$z\mapsto f_{1}(z)=z\cdot\frac{\ln\left(z\right)-1}{Lz-1}$$
and
$$z\mapsto f_{2}(z)=z\cdot\left[1+\frac{\ln\left(z\right)-L\cdot x^{z}}{L^{2}\cdot z\cdot x^{z}-1}\right]$$</p><p>Where \(L=\ln(x)\) can be precomputed. As Python code, the update procedures are:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># Initialize before iteration</span>
</span></span><span class=line><span class=cl><span class=n>L</span> <span class=o>=</span> <span class=n>log</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Iteration for y = x^y:</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>*=</span> <span class=p>(</span><span class=n>log</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>L</span> <span class=o>*</span> <span class=n>z</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Iteration for y = x^x^y:</span>
</span></span><span class=line><span class=cl><span class=n>Lxz</span> <span class=o>=</span> <span class=n>L</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=n>z</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>*=</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>log</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=o>-</span> <span class=n>Lxz</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>z</span> <span class=o>*</span> <span class=n>L</span> <span class=o>*</span> <span class=n>Lxz</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>To compute the infinite tetration <code>z</code> of <code>x</code>.</p><p>Note that both methods will work in the main region where the infinite tetration converges, but only the latter method will work in the oscillatory region. In the oscillatory region, the method will tend to converge to whichever three branches the seed is closest to (but this is not always the case&ndash;check out my previous blog post on <a href=https://blog.mileswaugh.com/posts/complex_fractals_desmos/ target=_blank rel=noreferrer>Newton Fractals</a>). The derivative of the more complicated method is:</p><p>$$f_{2}&rsquo;\left(z\right)=\frac{\left(z^{2}x^{z}L^{3}+1\right)\left(x^{z}L-\ln\left(z\right)\right)}{\left(zx^{z}L^{2}-1\right)^{2}}$$</p><p>This is what the convergence basin looks like, plotted in orange, behind the fixed-point infinite tetration curve, plotted in blue:</p><p><figure><img src=./media/svg/convergence_region.svg alt="Graph of the basin of convergence of the iteration" class="mx-auto my-0 rounded-md"></figure></p><p>In order to compute the tetration of a number \(x\), we must choose an initial guess \(y_0\) such that \(\left(x,y_0\right)\) is in the orange region and every point \(\left(x,y\right)\) for \(y\) between the initial guess \(y_0\) and the blue fixed-point \(y_{\infty}\) is also in the orange region.</p><p>Because we used the more &ldquo;complete&rdquo; curve \(x^{x^y}=y\), the fixed-point iteration \(f_{2}(y)\) can converge to any of the three branches present on the domain \(x\in\left(0,e^{-e}\right)\).</p><p>In order to use the method, however, we must provide the method with an initial guess that is close to the desired curve. We can do this by approximating the complex curve with a simpler curve.</p><p>For the main section on \(x\in\left(e^{-e},\sqrt[e]{e}\right)\), I employ a rational function approximation. If my approximation is \(R_{\beta}(x)\) where \(\beta\) are the parameters that determine a particular rational function, then my objective is to find those coefficients \(\beta\) that minimize the \(L_2\) norm of the error on the interval:</p><p>$$\min_{\beta}\int_{e^{-e}}^{\sqrt[e]{e}}\left(R_{\beta}\left(x\right)-y\left(x\right)\right)^{2}dx$$</p><p>Where \(y\) is the infinite tetration of \(x\). This approximation comes out to:</p><p>$$y\approx \frac{\left(1+2.051x\right)x-6.037}{\left(16.183-4.006x\right)x-15.134}$$</p><p>This is the approximation plotted below in red, with the actual infinite tetration curve plotted in blue, and the basin of convergence lightly shaded in orange:</p><p><figure><img src=./media/svg/main_seed.svg alt="Approximation of the main region of the infinite tetration curve." class="mx-auto my-0 rounded-md"></figure></p><p>I also wanted to approximate each of the branches in the oscillatory region. Sometimes, a mathematical regime is not needed to determine some &ldquo;optimal&rdquo; seed. Often, some educated guesswork suffices. In my case, I came up with these approximations based on the general shape of the curves that I was looking for. From top to bottom, the approximations are:</p><p>$$y_{1}\approx \frac{1}{e}\left(1+\left(e-1\right)e^{{e}/{2}}\sqrt{e^{-e}-x}\right)$$
$$y_{2}\approx e^{0.15e-1}x^{0.15}$$
$$y_{3}\approx \frac{1}{e}\left(1-\sqrt{1-e^{2e}x^{2}}\right)$$</p><p>These approximations look like this, plotted in red, with the actual infinite tetration curve plotted in blue, and the basin of convergence lightly shaded in orange:</p><p><figure><img src=./media/svg/branch_seed.svg alt="Approximation of the three branches in the oscillatory region of the infinite tetration curve." class="mx-auto my-0 rounded-md"></figure></p><hr><h3 id=results class="relative group">Results <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#results aria-label=Anchor>#</a></span></h3><p>In this last part, I will present the results of the approach. Recall the naïve approach:</p><p><figure><img src=./media/gif/naive_1.gif alt="Full naïve approach" class="mx-auto my-0 rounded-md"></figure></p><p>The derived Newton-Raphson iteration with my initial approximations converge much more quickly in difficult regions:</p><p><figure><img src=./media/gif/newton_1.gif alt="Full Newton Raphson approach" class="mx-auto my-0 rounded-md"></figure></p><p>In particular, compare the convergence of the naïve approach near the branching point:</p><p><figure><img src=./media/gif/naive_2.gif alt="Naïve approach near the branching point" class="mx-auto my-0 rounded-md"></figure></p><p>To the Newton-Raphson iteration:</p><p><figure><img src=./media/gif/newton_2.gif alt="Newton Raphson iteration near the branching point" class="mx-auto my-0 rounded-md"></figure></p><p>And compare the convergence of the naïve approach near the upper limit:</p><p><figure><img src=./media/gif/naive_3.gif alt="Naïve approach for large inputs" class="mx-auto my-0 rounded-md"></figure></p><p>To the Newton-Raphson iteration:</p><p><figure><img src=./media/gif/newton_3.gif alt="Newton Raphson for large inputs" class="mx-auto my-0 rounded-md"></figure></p><p>Here are the approaches overlaid for the main convergent section, with the Naïve approach in blue, the Newton-Raphson iteration in red, and the ground truth curve in green:</p><p><figure><img src=./media/gif/overlaid.gif alt="Both methods overlaid for the main convergent section" class="mx-auto my-0 rounded-md"></figure></p><p>Here is my full implementation of the method as a Python module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BRANCH_POINT</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>MAX_VALUE</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=mi>1</span> <span class=o>/</span> <span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compute_infinite_tetration</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>MAX_ITER</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>128</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tolerance</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1e-9</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=o>...</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Computes the infinite tetration of non-negative real numbers using the Newton-Raphson method.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        x (float): non-negative float to infinitely tetrate.
</span></span></span><span class=line><span class=cl><span class=s2>        MAX_ITER (int, optional): Number of maximum iterations allowed. Defaults to 32.
</span></span></span><span class=line><span class=cl><span class=s2>        tolerance (float, optional): Convergence tolerance. Defaults to 1e-9.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        tuple[float, ...]: The converged value, or the branches of the solution.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mf>0.0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>math</span><span class=o>.</span><span class=n>isclose</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>(</span><span class=o>-</span><span class=mf>1.0</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=s2>&#34;nan&#34;</span><span class=p>),)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>math</span><span class=o>.</span><span class=n>isclose</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>math</span><span class=o>.</span><span class=n>isclose</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=mf>1.0</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>BRANCH_POINT</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>z1</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>e</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>e</span> <span class=o>*</span> <span class=mf>0.5</span><span class=p>)</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>)</span> <span class=o>-</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span> <span class=o>/</span> <span class=n>math</span><span class=o>.</span><span class=n>e</span>
</span></span><span class=line><span class=cl>        <span class=n>z2</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=mf>0.15</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>e</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=mf>0.15</span>
</span></span><span class=line><span class=cl>        <span class=n>z3</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>math</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>)</span> <span class=o>*</span> <span class=n>x</span> <span class=o>*</span> <span class=n>x</span><span class=p>))</span> <span class=o>/</span> <span class=n>math</span><span class=o>.</span><span class=n>e</span>
</span></span><span class=line><span class=cl>        <span class=n>L</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Flags to check for convergence</span>
</span></span><span class=line><span class=cl>        <span class=n>c1</span> <span class=o>=</span> <span class=n>c2</span> <span class=o>=</span> <span class=n>c3</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># These will be L * x^z for each branch.</span>
</span></span><span class=line><span class=cl>        <span class=n>Lxz1</span> <span class=o>=</span> <span class=n>Lxz2</span> <span class=o>=</span> <span class=n>Lxz3</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Iterate for x^x^y = y until convergence</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>MAX_ITER</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># Keeping track of previous z&#39;s to check for convergence</span>
</span></span><span class=line><span class=cl>            <span class=n>zp1</span><span class=p>,</span> <span class=n>zp2</span><span class=p>,</span> <span class=n>zp3</span> <span class=o>=</span> <span class=n>z1</span><span class=p>,</span> <span class=n>z2</span><span class=p>,</span> <span class=n>z3</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Lxz1</span> <span class=o>=</span> <span class=n>L</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=n>z1</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Lxz2</span> <span class=o>=</span> <span class=n>L</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=n>z2</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Lxz3</span> <span class=o>=</span> <span class=n>L</span> <span class=o>*</span> <span class=n>x</span><span class=o>**</span><span class=n>z3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># These cases should NEVER occur. It is here just in case.</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>z1</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> encountered negative z1: </span><span class=si>{</span><span class=n>z1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>z1</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=n>z1</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>z2</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> encountered negative z1: </span><span class=si>{</span><span class=n>z2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>z2</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=n>z2</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>z3</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> encountered negative z1: </span><span class=si>{</span><span class=n>z3</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>z3</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=n>z3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Newton-Raphson iterations</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=n>c1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>z1</span> <span class=o>*=</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>z1</span><span class=p>)</span> <span class=o>-</span> <span class=n>Lxz1</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>z1</span> <span class=o>*</span> <span class=n>L</span> <span class=o>*</span> <span class=n>Lxz1</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=n>c2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>z2</span> <span class=o>*=</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>z2</span><span class=p>)</span> <span class=o>-</span> <span class=n>Lxz2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>z2</span> <span class=o>*</span> <span class=n>L</span> <span class=o>*</span> <span class=n>Lxz2</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=n>c3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>z3</span> <span class=o>*=</span> <span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>z3</span><span class=p>)</span> <span class=o>-</span> <span class=n>Lxz3</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>z3</span> <span class=o>*</span> <span class=n>L</span> <span class=o>*</span> <span class=n>Lxz3</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>Err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed with error: </span><span class=si>{</span><span class=n>Err</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z1</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z2</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z3</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz3</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z1</span><span class=p>,</span> <span class=n>z2</span><span class=p>,</span> <span class=n>z3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>ZeroDivisionError</span> <span class=k>as</span> <span class=n>Err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed with error: </span><span class=si>{</span><span class=n>Err</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z1</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z2</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z1 = </span><span class=si>{</span><span class=n>z3</span><span class=si>}</span><span class=s2>, Lxz1 = </span><span class=si>{</span><span class=n>Lxz3</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z1</span><span class=p>,</span> <span class=n>z2</span><span class=p>,</span> <span class=n>z3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Check for convergence</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>c1</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>z1</span> <span class=o>-</span> <span class=n>zp1</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>tolerance</span> <span class=o>*</span> <span class=nb>max</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>z1</span><span class=p>),</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>c2</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>z2</span> <span class=o>-</span> <span class=n>zp2</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>tolerance</span> <span class=o>*</span> <span class=nb>max</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>z2</span><span class=p>),</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>c3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>c3</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>z3</span> <span class=o>-</span> <span class=n>zp3</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>tolerance</span> <span class=o>*</span> <span class=nb>max</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>z3</span><span class=p>),</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>c1</span> <span class=ow>and</span> <span class=n>c2</span> <span class=ow>and</span> <span class=n>c3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>verbose</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Converged in </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> iterations.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z1</span><span class=p>,</span> <span class=n>z2</span><span class=p>,</span> <span class=n>z3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed to converge after </span><span class=si>{</span><span class=n>MAX_ITER</span><span class=si>}</span><span class=s2> iterations.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;x: </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>z1</span><span class=p>,</span> <span class=n>z2</span><span class=p>,</span> <span class=n>z3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>MAX_VALUE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span> <span class=o>=</span> <span class=p>((</span><span class=mi>1</span> <span class=o>+</span> <span class=mf>2.051</span> <span class=o>*</span> <span class=n>x</span><span class=p>)</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=mf>6.037</span><span class=p>)</span> <span class=o>/</span> <span class=p>((</span><span class=mf>16.183</span> <span class=o>-</span> <span class=mf>4.006</span> <span class=o>*</span> <span class=n>x</span><span class=p>)</span> <span class=o>*</span> <span class=n>x</span> <span class=o>-</span> <span class=mf>15.134</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>L</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Iterate for x^y = y until convergence</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>MAX_ITER</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>zp</span> <span class=o>=</span> <span class=n>z</span>  <span class=c1># previous z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>z</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># This should never occur. It is here just in case.</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> encountered negative z: </span><span class=si>{</span><span class=n>z</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>z</span> <span class=o>=</span> <span class=n>x</span><span class=o>**</span><span class=n>z</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Newton-Raphson iteration</span>
</span></span><span class=line><span class=cl>                <span class=n>z</span> <span class=o>*=</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>L</span> <span class=o>*</span> <span class=n>z</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>Err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed with ValueError: </span><span class=si>{</span><span class=n>Err</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z = </span><span class=si>{</span><span class=n>z</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>ZeroDivisionError</span> <span class=k>as</span> <span class=n>Err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed with ZeroDivisionError: </span><span class=si>{</span><span class=n>Err</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;z = </span><span class=si>{</span><span class=n>z</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>z</span> <span class=o>-</span> <span class=n>zp</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>tolerance</span> <span class=o>*</span> <span class=nb>max</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>z</span><span class=p>),</span> <span class=mf>1.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>verbose</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Converged in </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2> iterations.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>z</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;WARNING: iteration </span><span class=si>{</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s2> failed to converge after </span><span class=si>{</span><span class=n>MAX_ITER</span><span class=si>}</span><span class=s2> iterations.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;x: </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>z</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>math</span><span class=o>.</span><span class=n>isclose</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>MAX_VALUE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=s2>&#34;inf&#34;</span><span class=p>),)</span>
</span></span></code></pre></div><p>Potential improvements to my code could be to vectorize computations for the branched section of the curve using NumPy, using <a href=https://docs.python.org/3/library/math.html#math.fma target=_blank rel=noreferrer>math.fma()</a> to take advantage of multiplier–accumulators in modern CPUs, or just writing the code in a lower-level language like C++ or Rust instead. But the code is already blazingly fast for me, so I am satisfied with the approach.</p><p>Thanks for reading!</p></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Miles Waugh</div><div class="text-sm text-neutral-700 dark:text-neutral-400">I like to write about cool stuff :)</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href="https://github.com/piano-miles?tab=repositories" target=_blank aria-label=Github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://piano-miles.github.io/home/ target=_blank aria-label=Link rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 640 512"><path fill="currentcolor" d="M172.5 131.1c55.6-55.59 148-55.59 203.6.0 50 50 57.4 129.7 16.3 187.2L391.3 319.9C381 334.2 361 337.6 346.7 327.3c-14.4-10.3-17.8-30.3-7.5-44.6L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2c-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5.0 114C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4 265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1.0-204.5L172.5 131.1zM467.5 380c-56.5 56.5-148 56.5-204.5.0-50-50-56.5-128.8-15.4-186.3L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7 307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8c31.4 31.4 82.5 31.4 114 0L534.5 222.5c31.5-31.5 31.5-83.4.0-114C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58 374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06.0 204.46L467.5 380z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.linkedin.com/in/miles-waugh/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.youtube.com/@mileswaugh target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/complex_fractals_desmos/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Complex Fractals in Desmos</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-10-19 14:20:07 -0700 PDT">19 October 2024</time>
</span></span></a></span><span></span></div></div></footer></article><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">Miles Waugh</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex h-12 w-12 items-center justify-center dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden h-12 w-12 items-center justify-center dark:flex" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm sm:p-6 md:p-[10vh] lg:p-[12vh] dark:bg-neutral-900/50" data-url=https://blog.mileswaugh.com/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>